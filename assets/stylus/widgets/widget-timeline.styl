// Specific styles for widget-timeline-viz
#widget-timeline-viz
    .timeline-periods
        margin: 2rem 0
        display: grid
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr))
        gap: 2rem
        
        +media(mobile)
            display: none // Hide periods on mobile as requested
            
    .period
        h3
            margin-bottom: 0.5rem
            text-transform: uppercase
            letter-spacing: 0.05em
            
        p
            opacity: 0.8
            

    .viz-container
        margin: 0 // Zero margins for edge-to-edge visualization
        width: 100% // Full width
        padding: 1rem // No padding
        min-height: 600px // Minimum height
        overflow: visible // Allow content to be visible

    svg
        width: 100%
        height: auto
        min-height: 600px // Minimum height for desktop
        display: block
        overflow: visible

    // Year labels along the timeline
    .timeline-year-label
        @extend .sans-scheme
    

    // Period separator lines - now applies to all periods including first
    .period-separator
        stroke: brand-black
        stroke-width: 1


    // Period titles (era names) - positioned below timeline
    .timeline-period-title
        @extend .sans-caption
        text-transform: uppercase
        text-anchor: start

    // Period descriptions - positioned below timeline with width constraint and proper wrapping
    .timeline-period-description
        @extend .sans-scheme
        text-anchor: start
        dominant-baseline: text-before-edge
        
        tspan
            word-spacing: normal
            letter-spacing: normal

    // Antibiotic circles with responsive sizing
    .antibiotic-circle
        fill: brand-black
        stroke: none
        cursor: default
        transition: fill 0s
        
        // Ensure circles are perfectly round
        shape-rendering: geometricPrecision

        // Hover state - activates brand-pink class
        &.hovered
            fill: brand-pink

        &:hover
            fill: brand-pink

        // Active state for mobile scroll
        &.active
            fill: brand-pink

    // Mobile antibiotic names
    .mobile-antibiotic-name
        @extend .sans-scheme
        transition: opacity 0s
        margin-right: 0.5rem
        max-width: 40vw
        white-space: normal
        word-break: break-word
        
    // Antibiotic tooltip on hover
    .antibiotic-tooltip
        @extend .sans-scheme

    // Timeline popup styles - moved outside widget container to avoid overflow hidden
    
    // Mobile-specific adjustments
    +media(mobile)
        .viz-container
            padding: 0 // No padding on mobile either
            
        svg
            height: 1800px // Much more height for mobile spacing
            
        .timeline-year-label
            dominant-baseline: middle
            text-anchor: start // Year labels aligned to left on mobile
            
        .antibiotic-circle
            cursor: default // No cursor change on mobile
            
            // Disable hover on mobile
            &:hover
                fill: brand-black
                
            // Keep active state working on mobile
            &.active
                fill: brand-pink
                
        // Hide period descriptions on mobile to save space
        .timeline-period-description
            display: none
            
        .timeline-period-title
            display: none
            
        .period-separator
            display: none

    // Tablet and desktop specific adjustments
    +media(tablet-v)
        svg
            min-height: 600px // Minimum height for larger screens, but can grow
            
        // Ensure period descriptions are visible on larger screens
        .timeline-period-description
            display: block
            
        .timeline-period-title
            display: block
            
        .period-separator
            display: block

        // Hide popups on larger screens
        .timeline-popup
            display: none !important

    // Desktop specific refinements
    +media(desktop)
        .viz-container
            min-height: 600px // Ensure minimum height but allow growth
            
        .timeline-period-description
            // Text wrapping is handled in JavaScript
            tspan
                word-spacing: normal
                letter-spacing: normal

        // Hide popups on desktop
        .timeline-popup
            display: none !important

// Timeline popup styles - outside widget to avoid overflow conflicts
.timeline-popup
    position: fixed !important
    top: 7vh !important // Below the header bar (6vh + 1vh margin)
    left: 50% !important
    transform: translateX(-50%) !important
    max-width: 90vw
    width: 300px
    opacity: 0
    visibility: hidden
    transition: opacity 0s, visibility 0s
    pointer-events: none
    z-index: 2 !important // Higher than menu and widgets
    
    // Visible state
    &.visible
        opacity: 1 !important
        visibility: visible !important
        pointer-events: auto

    // Mobile specific popup positioning
    +media(mobile)
        top: 7vh !important
        left: 20px !important
        right: 20px !important
        transform: none !important
        width: auto !important
        max-width: none !important

    // Hide on larger screens
    +media(tablet-v)
        display: none !important
    
    +media(tablet-h)
        display: none !important
    
    +media(desktop)
        display: none !important

.timeline-popup-container
    position: relative
    width: 100%
    height: auto

.timeline-popup-shadow
    position: absolute
    top: 8px
    right: 8px
    width: 100%
    height: 100%
    background: brand-white
    border: 1px solid brand-black
    border-radius: 20px
    z-index: 1

.timeline-popup-main
    position: relative
    width: 100%
    background: brand-white
    border: 1px solid brand-black
    border-radius: 20px
    z-index: 2
    padding: 1rem
    
    h2 
        @extend .sans-scheme
        margin-bottom: 0.5rem
        margin-top: 0

    p 
        @extend .sans-scheme
        margin: 0

    +media(mobile)
        padding: 1rem

// Hide virtual (fake) dots used only for popup triggers
.antibiotic-circle.virtual
    display: none